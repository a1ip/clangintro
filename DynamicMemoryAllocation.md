##ДРУГИЕ ВОЗМОЖНОСТИ

###Динамическое распределение памяти. Функции ***malloc( )*** и ***free( )***

В языке Си принято следующее распределение памяти:

Таблица 4                                            

<center>
<table border="1" cellspacing="1" cellpadding="3"><caption></caption>
<tbody>
<tr>
<td>СТЕК</td><td>Верхние адреса</td>
</tr>
<tr>
<td>СВОБОДНАЯ ПАМЯТЬ</td><td></td>
</tr>
<tr>
<td>РАЗДЕЛ ГЛОБАЛЬНЫХ
ПЕРЕМЕННЫХ И КОНСТАНТ</td><td></td>
</tr>
<tr>
<td>КОД ПРОГРАММЫ</td><td>Нижние адреса</td>
</tr>
</tbody>
</table>
</center>

Для глобальных переменных отводится фиксированное место в памяти на все время работы программы. Локальные переменные хранятся в стеке. Между ними находится область памяти для динамического распределения.

Функции `malloc( )` и `free( )` используются для динамического распределения свободной памяти. Функция `malloc( )` выделяет память, функция `free( )` освобождает ее. Прототипы этих функций хранятся в заголовочном файле `stdlib.h` и имеют вид:

```c
void *malloc(size_t size);
void *free(void *p);
```

Функция `malloc( )` возвращает указатель типа `void`; для правильного использования значение функции надо преобразовать к указателю на соответствующий тип. При успешном выполнении функция возвращает указатель на первый байт свободной памяти размера `size`. Если достаточного количества памяти нет, возвращается значение `0`\. Чтобы определить количество байтов, необходимых для переменной, используют операцию `sizeof( )`.

Пример использования этих функций:

```c
#include <stdio.>
#include <stdlib.h>

void main(void)
{
   int *p, i;
   p = (int *) malloc(100 * sizeof(int)); /* Выделение памяти для 100
                                             целых чисел */
   if (!p)
   {
       printf("Недостаточно памяти\n");
       exit(1);
   }
   for (i = 0; i < 100; ++i) *(p+i) = i;    /* Использование памяти */
   for (i = 0; i < 100; ++i) printf("%d", *(p++) );
   free(p);                                   /* Освобождение памяти */
}
```

Перед использованием указателя, возвращаемого `malloc( )`, необходимо убедиться, что памяти достаточно (указатель не нулевой).